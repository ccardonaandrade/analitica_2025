---
title: "An√°lisis de la Calidad del Caf√©"

lang: es

format: 
  closeread-html:
   css: msaz.css
   code-tools: false
   fig-format: svg
   toc: true
   linkcolor: tomato
---

üìÖ **Fecha L√≠mite:** No hay fecha de entrega. Estos ejercicios son para que estudien. Los resolveremos en las clases del 3 y 10 de Marzo.


## An√°lisis de Calidad del Caf√© para Clientes Especializados

::: {.column-screen style="background-image:url(https://camo.githubusercontent.com/02ffb0ea07c6b9661808ff3fd1bec90a45e2f9112077119b0d15c80fd1956813/68747470733a2f2f696d616765732e756e73706c6173682e636f6d2f70686f746f2d313535303638313536302d6166396263316362333339653f69786c69623d72622d312e322e3126697869643d65794a6863484266615751694f6a45794d446439266175746f3d666f726d6174266669743d63726f7026773d3133353026713d3830); background-size: 100vw; height: 800px; background-position: center +15%; background-repeat: no-repeat;"}
:::

En este taller, asumiremos el rol de analistas de calidad para una empresa que asesora a tostadores y distribuidores de caf√© de especialidad. Se nos ha proporcionado una base de datos con evaluaciones de distintos caf√©s de diversas regiones del mundo. Nuestro objetivo es analizar estos datos para identificar patrones en la calidad del caf√© y ofrecer recomendaciones a nuestros clientes.

La base de datos contiene informaci√≥n detallada sobre las caracter√≠sticas sensoriales del caf√©, como aroma, sabor, acidez, cuerpo y balance, as√≠ como la calificaci√≥n general (total_cup_points). Tambi√©n incluye variables como el pa√≠s de origen y el nivel de humedad del grano. A continuaci√≥n, se detallan las principales variables:


`total_cup_points`: Puntuaci√≥n total del caf√© en una escala de 0 a 100.

`species`: Especie de grano de caf√© (por ejemplo, ar√°bica o robusta).

`country_of_origin`: Pa√≠s de origen del grano de caf√©.

`aroma`: Calificaci√≥n otorgada al aroma del caf√©.

`flavor`: Calificaci√≥n otorgada al sabor del caf√©.

`aftertaste`: Calificaci√≥n otorgada al sabor residual del caf√©.

`acidity`: Calificaci√≥n otorgada a la acidez del caf√©.

`body`: Calificaci√≥n otorgada al cuerpo del caf√© (sensaci√≥n en boca).

`balance`: Calificaci√≥n otorgada al balance del caf√© (equilibrio entre atributos).

`uniformity`: Calificaci√≥n otorgada a la uniformidad del caf√©.

`clean_cup`: Calificaci√≥n otorgada a la limpieza de la taza (ausencia de defectos).

`sweetness`: Calificaci√≥n otorgada a la dulzura del caf√©.

`cupper_points`: Puntuaci√≥n otorgada por el catador en la evaluaci√≥n final.

`moisture`: Nivel de humedad del grano de caf√©.

`altitude_mean_meters`: Altitud promedio (en metros) a la que se cultiv√≥ el caf√©.



## Ejercicio 1


Abran un R Script, y utilizando la siguiente plantilla, carguen el paquete `tidyverse` y `corrplot`. Instalen `corrplot` porque es la primera vez que lo utilizamos.

```{r}
#| eval: false
#| echo: true
## ------------------------------
## An√°lisis de Caf√©
##
## Autor(es): 
##
## Fecha: 
## ------------------------------

## establecemos el directorio de trabajo
## En esta carpeta deber√≠an estar los datos
setwd("C:/Users/nombre_apellido/OneDrive/Documentos/analitica_cafe/data")
   
## cargamos todos los paquetes que usaremos en la sesi√≥n:

library(tidyverse)
library(corrplot)

## ---------------------------

### Ejercicio 1

coffee_data <- read.csv("coffee_ratings.csv")
glimpse(coffee_data)

```

## Ejercicio 2

Reescriban los datos `coffee_data` de manera que s√≥lo tengan las variables:

- `total_cup_points`

- `species`

- `country_of_origin`

- De `aroma` a `moisture`

- `altitude_mean_meters`

## Ejercicio 3

Construyan el histograma de la variable `total_cup_points`. 

De acuerdo al histograma, ¬øcu√°l es el valor del dato at√≠pico?

Ejecuten el siquiente c√≥digo para eliminar ese sesgo:

```{r}
#| echo: true
#| eval: false
coffee_data <- coffee_data |>
  filter(total_cup_points>50)
```


## Ejercicio 4

Construyan un diagrama de caja para `total_cup_points` e incluyan una l√≠nea vertical punteada que indique la calidad promedio de los caf√©s producidos en Colombia. Analicen la posici√≥n de esta l√≠nea en comparaci√≥n con la distribuci√≥n general de la calidad del caf√© en la muestra. ¬øQu√© podemos concluir sobre la calidad de los caf√©s colombianos en relaci√≥n con los dem√°s?

## Ejercicio 5

Uno de nuestros clientes cree que la calidad promedio del caf√© en el mundo es de **80 puntos**. Usando los datos, realicen una prueba de hip√≥tesis con un nivel de significancia del 5% para evaluar esta afirmaci√≥n. ¬øPodemos rechazar la hip√≥tesis nula o no? Expliquen su conclusi√≥n.

## Ejercicio 6

- Si rechazamos la hip√≥tesis nula cuando en realidad es verdadera, ¬øqu√© tipo de error estar√≠amos cometiendo? Explica las consecuencias de este error en el contexto de la calidad del caf√©.

- Si no logramos rechazar la hip√≥tesis nula cuando en realidad es falsa, ¬øqu√© tipo de error estar√≠amos cometiendo? ¬øQu√© implicaciones tendr√≠a esto para la industria del caf√©?

## Ejercicio 7

Construyan un histograma y un diagrama de caja para la variable altitude_mean_meters. Adem√°s, calculen los cinco n√∫meros resumen: m√≠nimo, primer cuartil (Q1), mediana, tercer cuartil (Q3) y m√°ximo.
Con base en las gr√°ficas y los estad√≠sticos descriptivos, describan la forma de la distribuci√≥n (sim√©trica, sesgada, presencia de valores at√≠picos, etc.).

## Ejercicio 8

Estimen un intervalo de confianza para la media de `altitude_mean_meters` al 90% y 95%.

- ¬øLos intervalos son muy diferentes?

- ¬øCu√°l recomendar√≠an para estimar la altitud promedio de los cultivos de caf√© en el mundo y por qu√©?


## Ejercicio 9

Uno de nuestros clientes cree que la altitud promedio de los cultivos de caf√© en el mundo es de **1300 metros**. Usando los datos, realicen una prueba de hip√≥tesis con un nivel de significancia del 5% para evaluar esta afirmaci√≥n.

- ¬øPodemos rechazar la hip√≥tesis nula o no?

- Expliquen su conclusi√≥n en t√©rminos sencillos para el cliente.

## Ejercicio 10

Si rechazamos la hip√≥tesis nula y concluimos que la altitud promedio de los cultivos de caf√© es diferente de 1300 metros, el cliente podr√≠a decidir invertir en nuevas plantaciones a diferentes altitudes. Sin embargo, si en realidad la altitud promedio s√≠ es 1300 metros, ¬øqu√© tipo de error estar√≠amos cometiendo y qu√© consecuencias podr√≠a tener esta decisi√≥n para el cliente?


## Ejercicio 11

1. Creen una variable llamada `colombia`, que tome el valor `TRUE` si el pa√≠s de origen del caf√© es Colombia y `FALSE` en caso contrario.

2. Realicen una prueba de hip√≥tesis para comparar la calidad promedio (`total_cup_points`) del caf√© colombiano vs. los dem√°s caf√©s usando `t.test()`:

$$H_0: \mu_{\text{Colombia}}=\mu_{\text{No Colombia}}$$
$$H_A: \mu_{\text{Colombia}}\neq\mu_{\text{No Colombia}}$$


3. Bas√°ndose en el intervalo de confianza del `t.test()`, decidan si pueden rechazar la hip√≥tesis nula con un nivel de significancia del 5%. Expliquen su conclusi√≥n en t√©rminos sencillos.

## Ejercicio 12

Dado que no rechazamos la hip√≥tesis nula, estamos concluyendo que la calidad promedio del caf√© colombiano no es significativamente diferente de la de otros pa√≠ses. Sin embargo, si en realidad s√≠ hubiera una diferencia en la calidad, ¬øqu√© tipo de error estar√≠amos cometiendo? ¬øQu√© impacto podr√≠a tener esta conclusi√≥n en las decisiones de exportaci√≥n y marketing del caf√© colombiano?


## Ejercicio 13

Construyan un diagrama de caja para comparar la distribuci√≥n de `total_cup_points` entre los caf√©s colombianos y los de otros pa√≠ses. ¬øC√≥mo se compara la calidad del caf√© colombiano con la de los dem√°s caf√©s en la muestra?

## Ejercicio 14

¬øLos caf√©s colombianos crecen, en promedio, a una altitud mayor que los dem√°s caf√©s?

1. Formulen las hip√≥tesis para comparar la altitud promedio (`altitude_mean_meters`) de los caf√©s colombianos vs. los no colombianos.

$$H_0: \mu_{\text{Colombia}}=\mu_{\text{No Colombia}}$$
$$H_A: \mu_{\text{Colombia}}>\mu_{\text{No Colombia}}$$

2. Realicen la prueba de hip√≥tesis usando `t.test()`. 

Como queremos comprobar si la altitud promedio de los caf√©s colombianos es mayor que la de los dem√°s caf√©s, realizaremos una *prueba de una cola*. Para ello, deben agregar la opci√≥n `alternative = "greater"` en el comando.

3. Interpreten el p-value:

  - ¬øPodemos rechazar la hip√≥tesis nula al 5%?

  - ¬øQu√© significa esto en t√©rminos de la altitud promedio de los caf√©s colombianos?

## Ejercicio 15

Ejecuten el siguiente c√≥digo para ver la matriz de correlaciones. El paquete `corrplot` es una buena manera de visualizar la matriz.


```{r}
#| echo: true
#| eval: false
coffee_vars_cor <- coffee_data |>
  select(total_cup_points, aroma, flavor, aftertaste,
         acidity, body, balance, uniformity, sweetness, cupper_points, moisture)
corrplot(cor(coffee_vars_cor), method = 'number', type = "upper")

```

Elijan una variable que se correlacione de manera d√©bil con `total_cup_points` y una que se correlacione de manera fuerte.  Basados en los siguientes c√≥digos, construyan un diagrama de dispersi√≥n con cada una de estas variables en el eje `x` y `total_cup_points` en el eje `y`. Reemplacen `__________` con las variables que seleccionaron. 

¬øLos patrones observados en los gr√°ficos reflejan la magnitud de las correlaciones?


::: columns
::: {.column width="50%"}

```{r}
#| echo: true
#| eval: false
ggplot(coffee_data) +
  geom_point(aes(y=total_cup_points,x=__________)) +
  xlim(0,10)+ ylim(50,100)+
  labs(y="Total Cup Points",
       x="_________", 
       title = "Low Correlation")+
  theme_minimal()
```
:::

::: {.column width="50%"}

```{r}
#| echo: true
#| eval: false
ggplot(coffee_data) +
  geom_point(aes(y=total_cup_points,x=__________)) +
  xlim(0,10)+ ylim(50,100)+
  labs(y="Total Cup Points",
       x="_________", 
       title = "High Correlation")+
  theme_minimal()
```

:::
:::

